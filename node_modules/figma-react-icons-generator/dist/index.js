#!/usr/bin/env node
"use strict";
var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const yargs_parser_1 = __importDefault(require("yargs-parser"));
const exporter_1 = require("./exporter");
const convert_1 = require("./convert");
const utils_1 = require("./utils");
const args = (0, yargs_parser_1.default)(process.argv.slice(2));
const parser = () => {
    const config = {
        output: args.o || args.output,
        figmaToken: args.t || args.token,
        figmaFile: args.f || args.file,
        figmaCanva: args.c || args.canva,
    };
    let property;
    for (property in config) {
        if (typeof config[property] === 'undefined')
            process.exit(1);
    }
    run(config);
};
const run = (config) => __awaiter(void 0, void 0, void 0, function* () {
    const svgs = (0, convert_1.SVGToReactComponent)(yield (0, exporter_1.getSvg)(config.figmaToken, config.figmaFile, config.figmaCanva));
    svgs.forEach((item) => {
        (0, utils_1.saveComponents)(config.output, item.name, 'js', item.component);
    });
    (0, utils_1.createIndex)({
        componentsFolder: config.output,
        indexFolder: config.output,
        indexFile: 'index.js',
    });
});
parser();
